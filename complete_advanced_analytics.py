#!/usr/bin/env python3
"""
Complete Advanced Aadhaar Analytics - All 6 Techniques
Implements: Isolation Forest, ARIMA, K-means, Control Charts, Geospatial Analysis, Network Analysis
"""

import pandas as pd
import numpy as np
impoues()l_6_techniqlyzer.run_al anatics()
   edAnalypleteAdvancer = Com   analyz
 __": "__main_name__ ==f _)

i'"report.txt_advanced_mplete'cos t saved apors reiclytanced ana advlete"âœ… Comprint( 
        p
       ite(report)f.wr         ) as f:
   , 'w'report.txt'ed__advanc'completeh open(       wit
       ""
  y.
"deliverservice ations and dhaar operent of Aaus improveminuom for
contecosysteal st analyticobu creates a rtechniques 6 tion of all integraheties

Tpabilitection caomaly deed anomatAutâ€¢ ortunities
ppation oaborlltate co
â€¢ Inter-s strategiesion optimizatgraphicystem
â€¢ Geoitoring s monrolconty ualitanning
â€¢ Qplsource ties for ree capabili Predictivframework
â€¢ion making driven decis
â€¢ Data-provides:e analysis sivprehen com======
This=======
=====MPACTL I
OPERATIONAnalysis
 a centralityucture and strunityCommInsights: ork 
â€¢ Netwsteml scoring sy-dimensiona: Multiionicatt Identifspootâ€¢ Hplemented
ules imation riple violultvity: Mrt Sensititrol Chaon Ced
â€¢achievcores  steouetal silhty: Optimng Qualisteriion
â€¢ Clu validat statistical models withlity: ARIMAReliabiast tes
â€¢ Forecutlier stang oyi identifrecision ingh p Hin Accuracy:ly Detectio
â€¢ Anoma===============ETRICS
====MANCE M

PERFOR detectionmunityand comres y measu centralitry withraph theo Gysis:twork Analg
â€¢ Nesteringraphic cluing with geoort scotsporiteria hal: Multi-cspaties
â€¢ Geoulation rioliple vth multarts wintrol ch coigmal: 3-sontrotical Cn
â€¢ Statisoptimizatiouette score s with silho: K-meanring
â€¢ Clusteselectionarameter omated p with aut ARIMAodelstsmies: staSerâ€¢ Time est
 Forsolationkit-learn Ining: scie LearMachin
â€¢ ======================
==ONENTATILEML IMP

TECHNICAemssyst detection ven anomalydri AI-nt Implemeks
4.etworation nlabore cold inter-stat. Buil
3thms algorizationl optimie geospatiareatarts
2. Ccontrol che using aintenancedictive m prelop:
1. DevTIVES-TERM INITIAms

LONGteitoring sysl-time monoy reaDeplnities
4. muom cetworkased on non bl coordinatiionatablish reg. Esnning
3 placesourly refor quarterts ecasorUse ARIMA f
2. ogramst prvemenmprospecific ister-ment clu
1. ImpleS:EGIEATTRM-TERM S

MEDIUe sharingticbest pracs for nectionone network c Leverags
4.tspotl need ho criticatotion ource allocaze resities
3. Prior-volume stats in high violationarts control chddresst
2. Alation Foreified by Isostates identomalous gate annvestiNS:
1. IIOE ACT==
IMMEDIAT===================TIONS
====MENDACOM RESTRATEGICtunities

opporharing edge-sn and knowlratiolabo reveal col patternsstatenter-ORK: Ins
6. NETWcisiollocation de resource aesiziorits prsi analyotspot HATIAL:EOSPs
5. G issueontrollity creveals quaring cal monitostiOL: StatiCONTRSS ROCE4. Pons
ntinterveed ir targetes foriance categoormperfouped into  States grLUSTERING:ing
3. Canne plurcresotions for h predic 6-mont providedelsA mo ARIMNG:CASTIion
2. FOREe investigatmmediating iuires reqied stattifrning idenine lea: MachLY DETECTIONMA===
1. ANO=============
======IGHTSEHENSIVE INS"

COMPRf""= port +  re
      
        .3f})\n"_central[1]:ty: {most} (Centralial[0] {most_centrl State:ost Centra Mport += f"â€¢          re        1])
  a x: x[, key=lambd()data.itemstrality_= max(central cen      most_          a:
    _datlity if centra    
           lity']centra['degree_rk_metrics']a['network_dat = networality_data     cent     
      cs']:etri_metworkork_data['n in netwy'_centralitee and 'degrtwork_datas' in nework_metric 'net   if
                 """
    
es)}mmunitilen(co: {etecteds D Communitie(G):.3f}
â€¢ensity{nx.d: Densityetwork  Ndges()}
â€¢umber_of_eG.nns: {rk Connectio
â€¢ Netwof_nodes()}_obers: {G.numdeNoNetwork ======
â€¢ ======================ALYSIS
=WORK AN6: NETUE HNIQ""
TEC f"t +=por   re                
     , [])
nities'ommu_data.get('cnetworks = ommunitie        c    raph']
work_data['gG = net            s']
lysiwork_anaesults['netlf.rse = ta_da  network          .results:
selfysis' in nalork_a    if 'netw 
    
       \n"e']:.3f}need_scorresource_ore {row[' {state}: Scf"  {i}.rt +=     repo      ):
      ws(), 1.iterrotestaop_need_s(tmeraterow) in enutate, r i, (s       fo  re')
   need_sco, 'resource_t(5data.nlargest_es = hotspo_need_stat   top         :
"""
estatority Socation Priesource All 4
â€¢ Rfied:ters Identic Clusphieogra
â€¢ Gs}eed_statetes: {high_n Need Staâ€¢ High
_states}criticalStates: {cal Need  Criti
â€¢====================================S
====LYSINAAL HOTSPOT AGEOSPATI5: 
TECHNIQUE += f"""ort  rep      
                eed'])
 High N== 'y'] ce_categorta['resourdata[hotspot_ot_dalen(hotsps = _state  high_need    '])
      ritical Need'Cry'] == tego'resource_caa[datot_ta[hotsppot_daen(hots= ls teitical_sta    cr       ta']
 pots']['dahotsospatial_['geults= self.resata    hotspot_d
         sults:n self.repots' ipatial_hots   if 'geos  
       n"
    ntrol)\t-of-co.1f}% ouct']:rol_pof_cont['out_ ({data violationsns']}iolatiotal_vdata['to: {i}. {state} { f" report +=            1):
    3], on_ranking[:te(violatinumera in eata)ate, dor i, (st  f         e=True)
 erss'], reviolation_v]['total[1bda x: xs(), key=lam_data.itemcontroled(ing = sortank violation_r                
 
      n"tions:\est Violath Highates wi+= f"â€¢ St  report        "
   f}%\nontrol:.1f_cout_oate: {avg_ntrol Rut-of-CoAverage O"â€¢ port += f  re          s}\n"
violation: {total_ionsol Violatl Contrâ€¢ Totat += f" repor           }\n"
a)rol_datn(contnitored: {le States Mo+= f"â€¢rt       repo         
       ues()])
  ta.valn control_dadata il_pct'] for trot_of_conoumean([data['rol = np.ntut_of_co    avg_o])
        lues()l_data.va in contro for datans']iootal_violat['t = sum([datal_violations   tota         _charts']
controlults['.res = selfcontrol_data   
         lf.results:ts' in seontrol_char  if 'c     
 
        ""=====
"===============================L
====ONTROL PROCESS CSTATISTICA4: CHNIQUE m')}

TEY-%me('%().strfti'].max'dateic'][trme['bioelf.data {s to-%m')}'%Yime(strftin().].mdate'ometric']['['biataelf.dPeriod: {s
â€¢ Analysis )}nce']te_performa'staelf.data[ed: {len(syz States Anal
â€¢} recordsllment']):,'enro.data[a: {len(selflment Dat
â€¢ Enrolords  ']):,} recicemographa['dlen(self.datpdates: {emographic Uecords
â€¢ D,} rtric']):biomeata['n(self.d {lees:ic Updatiometr
â€¢ B------------EW
----OVERVI

DATASET ery Discovate Patternnter-stLYSIS - ITWORK ANAon
6. NEicatintif IdespotResource HotANALYSIS - PATIAL OSoring
5. GEonit- Quality MNTROL ESS COAL PROCICSTATIST4. ng
Groupi) - State (K-meansANALYSIS G STERIN
3. CLUtics  ictive AnalyredARIMA) - PG (CASTINS FORE SERIE
2. TIMEectionly Det) - Anomastation ForeING (IsolLEARNE 
1. MACHINues:
cal techniqalyti annced 6 advam allts frots result presenorehensive rep compr------
This
-----------RYUMMATIVE SEXECU}

%M:%S')-%d %H:%m('%Y-ftimeme.now().strdatetited: {===
Genera==================================RT
=====ALYTICS REPOD AADHAAR ANDVANCE AMPLETE"""
COeport = f
        r""" techniquesl 6ort for alve repcomprehensiate """Gener      :
  elf)ort(s_repmpleterate_co def _gene    
   
    s report")sive analysi- Comprehent.txt poradvanced_re complete_   print("â€¢")
     hboardasnteractive d- Ird.html oavanced_dashbte_ad comple("â€¢nt  pris")
      workern nette pattr-stag - Intepnlysis.twork_anane 6_print("â€¢
        pots")ocation hotssource alls.png - Repotial_hots_geospat"â€¢ 5rint( p     )
  lysis"rol anass contocetical prStatiss.png - trol_chart_connt("â€¢ 4
        priles:")Generated Fiint("   pr  "*70)
   int("=      prULLY!")
  SFETED SUCCESES COMPLECHNIQU ADVANCED TðŸŽ‰ ALL 6rint("\n p      
       port()
  complete_ref._generate_       sel
 ive reportcomprehenserate final  Gen    #      
    hboard()
  e_dasnsivheprete_comelf.crea  s  
    boardve dashehensiate compr    # Cre   
    
     ysis()aletwork_anhnique_6_nlf.tec    se
    ts()otspo_hialpat_5_geosue.techniq        self()
tscontrol_charque_4_echnilf.t        se       
s 4-6
 echnique t newn thel ru     # We'lipt)
   ous scr previemented in impl-3 (alreadyues 1Techniq   #     
        
 *70)"="t(rin      p
  CHNIQUES")VANCED TEL ADEXECUTING ALint("
        pr70)+ "="*"\n" nt(  priues
       6 techniqllun a
        # R
        d_data()loa self.    d data
        # Loa     
 )
     t("="*70   prin")
     NIQUESTECHICS AAR ANALYTDHADVANCED AAG ALL 6 IN"ðŸš€ RUNN      print(
  iques"""echnnced t 6 advallRun a" ""
       s(self):_6_technique def run_all 
         ")
 l'.htmhboarddasanced_te_advs 'compleed ard savete dashboa("âœ… Complprint      
  rd.html")ced_dashboamplete_advan"cowrite_html(       fig.shboard
  Save da      #   
  )
             alse
egend=F showl           ight=1400,
     he     _x=0.5,
         title     
niques", TechAll 6ashboard - lytics Ddhaar Ana Aae Advancedomplet_text="C     titleut(
       update_layo fig.t
       pdate layou       # U
        
 s)technique with all 6 ontinue heren would ctatio(Implemen      # nique...
  ch techr ea foAdd traces    #      
    
       )    ]
    }]
        : "bar"""typear"}, { "b"type":     [{          ,
  "bar"}]"type":{, atter"}e": "sctyp"        [{        er"}],
": "scattyper"}, {"tcatteype": "s    [{"t           ecs=[
        sp   ),
        '
      ty Analysisrk Centrali  'Netwo       
       ots',urce Hotspl Resoeospatia          'Gns',
      olatioart Vitrol Ch     'Con           , 
Clusters'eans State        'K-m      
   recast',  'ARIMA Fo              
Anomalies',st olation Fore      'Is   =(
       bplot_titles     su2,
       s=, colws=3       ro
     plots(e_subg = mak    fiques
    hnih all 6 techboard witdasly e Plot # Creat 
       
       "*60)"=   print(     
BOARD")CTIVE DASHVE INTERAEHENSIG COMPRTIN\nðŸ“Š CREA"  print("
      "ashboard"teractive dnsive incompreheeate "Cr"      "d(self):
  hboarensive_daseate_compreh
    def cr        t.show()

        pls='tight')_inchepi=300, bboxs.png', dalysiwork_anig('6_netefplt.sav   t()
     ht_layoutig  plt.             
 
))=0.8phaheat', alcecolor='wund', fa='ro(boxstyle bbox=dict                         , 
    es,1].transAxorm=axes[1     transf                  
       x_degree}',gree: {ma}\nMax De:.1fee: {avg_degrAvg Degree8, f' 0..7,ext(0es[1,1].t  ax             egrees)
  = max(ddegreex_          ma     ees)
 mean(degregree = np._d    avg   
          statisticsdd# A                
          ')
      weight='boldntfo='bottom', va,  ha='center'height)}',     f'{int(                            ght,
 )/2., heiidth(et_wr.g + bax()xt(bar.get_[1,1].te axes                eight()
   et_h.gheight = bar                  
  in bars:r bar        fo         s on bars
ue labeld val # Ad                   
            3)
ha=0.(True, alp[1,1].grid   axes           tes')
   of Staumber'Nel(t_ylabses[1,1].     axe           
ns)')ectiof ConnNumber oree (abel('Deg1].set_xl1,s[axe              )
  d'olntweight='bfoze=14, ontsiribution', fee Distgr'Network Detle(1,1].set_ti  axes[             ack')
 or='blgecol.7, eden', alpha=0ghtgret, color='li counts_lisgrees_list,bar(de axes[1,1].ars =        b           
           ())
  ounts.valuesee_clist(degr= ounts_list   c           s())
   e_counts.keylist(degre = _list     degrees       :
    ee_counts     if degr  
               0) + 1
   (degree,ts.getree_counegree] = deg_counts[dgree        de    rees:
    ree in degdegr          fo= {}
   nts degree_cou            es()]
nodn in G.e(n) for s = [G.degre      degree   n
   tributio Degree dis           #
  > 0:_of_nodes()mbernu  if G.s
      ysiucture analtrwork sNet      # 4.       
3)
    alpha=0.d(True, xes[1,0].gri       ad()
     s[1,0].legen         axe   
ntsize=8)', fo='rightn=45, ha rotatiol.index,(top_centrals_xticklabe1,0].setes[    ax
        ks(x)0].set_xtics[1,         axe   re')
trality Sco_ylabel('Cen0].set     axes[1,  
     tes')_xlabel('Staxes[1,0].set  a      bold')
    ght='ntweifo4, fontsize=1tes',  Sta Top 10ures -lity Meastle('Centra.set_ti[1,0]     axes              
   a=0.8)
  ctor', alphve'Eigenel= labdth,ector'], wieigenvop_central[', tthid*w 1.5(x +.bar0][1,  axes
          ha=0.8)seness', alpl='Cloabeh, lss'], widt'closeneal[_centrdth, top.5*wi0].bar(x + 0es[1,         ax.8)
   alpha=0s', etweennesbel='Bdth, lawieenness'], ntral['betwh, top_ce0.5*widtx - .bar(axes[1,0]            a=0.8)
 alphegree',th, label='Dee'], widntral['degrh, top_ce*widt - 1.5r(xaxes[1,0].ba       
            
     th = 0.2     widl))
       ntralen(top_cep.arange(= n        x   
    
          ')10, 'degreergest(_df.nla centralityl =ntra    top_ce       entrality
  by degree c0 stateselect top 1  # S
                      0)
na(ll}).fi           
  {})y',r_centralit('eigenvectotrics.get network_megenvector':'ei              y', {}),
  itentralss_cenet('closrics.genetwork_metloseness':           'c
      , {}),ty'ess_centralieenns.get('betwricork_metnness': netw'betwee             }),
   trality', {enet('degree_ccs.gmetrik_etwore': ngre   'de          Frame({
   = pd.Datadf rality_   cent:
         icsk_metror in netwity'_centralegreetrics and 'dmerk_netwo    if rison
    paeasures comrality ment    # 3. C    
        belpad=15)
la, ation=270ent', roton Coeffici'Correlatit_label(cbar.se])
        x=axes[0,1rbar(im, a.colo = plt   cbar     d colorbar
 # Ad 
       ')
       ight='boldfontwentsize=14,  fotates)',op 20 Satrix (Tarity M'State Simil_title(s[0,1].set     axe   ntsize=8)
.index, fom_subsetcklabels(si_ytiset  axes[0,1].
      ex)))m_subset.inde(len(si(rang].set_yticks0,1      axes[=8)
  zet', fontsi5, ha='righn=4rotations, olumet.cm_subscklabels(siset_xti,1].      axes[0)))
  set.columnsuben(sim_s(l(rangeticks0,1].set_x       axes[)
 ='auto' aspect vmax=1,1,n=-', vmip='coolwarms, cmaset.valueow(sim_subimsh0,1].im = axes[   
      ]
       _states, toptop_statesc[loity_matrix.similar= sim_subset    
     dextal_bio').in0, 'toargest(2ce'].nlerformanata['state_pelf.dtes = ssta   top_tes)
     ta20 smap (top eatx hity matri. Similar
        # 2 
        right')'upperoc=ements, legend_el=ldlesd(han0,0].legen     axes[  ()]
     lors.items_coor in rolecolrole, r         fo                   )
  abel=role, lsize=10lor, markeracecolor=co  markerf                                     ='w', 
 ', colorker='o [0], marne2D([0],t.Liplts = [enemnd_el  lege          les
 for rogendd le       # Ad    
   
          ='bold')ght, fontwei=14sizent foork',etwy NSimilaritInter-State t_title('[0,0].se        axes      
        
   width=2)            .8,
      =0pha  al                y', 
 color='graedge_            ,
       eight='bold'    font_w               ize=6, 
font_s                
    =True,ls with_labe            es,
      iz=node_sze   node_si            rs, 
    node_coloe_color=       nod            
xes[0,0], G, pos, ax=araw(x.d         n   k
Draw networ       #           
)
       (sizees.appendode_siz         n0))
       ates / 500al_updot min(2000, t0,ax(10= m  size         
      s']l_updatede]['totanodes[nos = G.updateotal_          t   :
    G.nodes()or node in       f = []
      node_sizes        tes
   tal updaon tobased Node sizes      #  
               es()]
   odin G.nnode  for ghtblue')le'], 'linode]['roles[get(state_ros.[role_colore_colors =         nodray'}
    d': 'lightgsolatew', 'I'yelloal': riphernge', 'Pe 'oraector':d', 'Conn {'Hub': 'relors =    role_co   
     olesbased on rolors  c Node          #       
     
  =42) seedons=100,ti, k=2, itera_layout(Gspringos = nx.      p      > 0:
 es()_of_nod G.number  ifon
       visualizatiraphrk gNetwo.         # 1    
   ld')
 'botweight=on6, fize=1', fontsTTERNSSTATE PATER-- INLYSIS ETWORK ANAuptitle('Nfig.s))
        (20, 15gsize=, fi(2, 2plt.subplots= xes   fig, a  
    """ysis resultsnetwork anal"Plot ""      es):
  te_rolatrix, staty_m, similaritrics network_me, G,lfis(sek_analysot_networ _pl  
    def      ate_roles)
 strity_matrix,cs, similatri, network_menalysis(Grk_alot_netwolf._p        seization
ualate vis  # Cre      
     }
           )
nities', [].get('commuwork_metricsities': netcommun  '       roles,
   state_': estate_rol       's   etrics,
  twork_mrics': neork_met  'netw  
        trix,arity_mailix': simrity_matr    'simila    ,
    h': G  'grap      '] = {
    alysisnetwork_anults[' self.res
         ")
      t} statesun{role}: {co     print(f"         tems():
 _counts.int in rolee, cou rol     for
   ORK:")OLES IN NETWE RSTATnðŸ“Š rint(f"\   p   
      1
     le, 0) +get(rorole_counts.ts[role] = ole_coun      r']
      ['rolenfoole = i      r
      ms():itee_roles.at, info in st  for state}
      e_counts = {        rolt roles
   # Coun    
        }
          ))
   ghbors(node list(G.neins':onnectio     'c
           degree,egree':  'd            ole,
   le': rro    '       
     [node] = { state_roles         
         Hub"
     = " role              
  lse:     e      r"
 nnectole = "Coro              :
   <= 3f degree         eli
   al"ripher "Pe  role =          :
     degree == 1      elif   "
   = "Isolatedrole             == 0:
    f degree          inode)
   ree(.deg  degree = G          ):
nodes( G. for node in      s = {}
 le    state_rowork
    n netes iole ryze stat      # Anal    
  
    ] = []ties'nimuetrics['comork_m       netwld")
     rent threshoth curound witions fNo connecnt("         pri         else:
      
 
      ))"ral[1]:.3f}ntst_ceral[0]} ({mo{most_cent}: etric_name Highest {m"    print(f            1])
      bda x: x[, key=lam()ms.itealues(metric_ventral = maxost_c         m       :
    ic_valuesct) and metrlues, dimetric_vace( isinstan      if
          s():cs.itemriwork_metn netic_values ie, metrmetric_nam  for          S:")
  STATE INFLUENTIALST\nðŸŽ¯ MO   print(f"     states
    ost central y m   # Identif        
        le")
     abot availtection nty de"   Communi   print(           = []
   ities      commun    ept:
      exc           ies
 ] = communitcommunities'cs['metrik_      networ                    
         }")
     munity)[:3])omlist(c, '.join(Examples: {'"       t(fin  pr              
        ")y)} statescommunit}: {len(ity {i+1ommun  Cf"   t(     prin                
    1:y) >nitlen(commu        if          
   es):te(communitiy in enumeraunitfor i, comm                 
          )
     "nities)}commued: {len(ities detectmmunint(f"   Co      pr         )
 es(G)communitiy_ritedy_modulaommunity.grenx.ces = list(ti   communi         
    try:           
  communitiestify  # Iden              
 
       )}"ng:.3f_clusteriient: {avgfficstering coe Average clu"  t(f   prin        
          )
   ing(Gclusterx.average_ng = neriust      avg_cl
      ering(G)lust= nx.cicient'] ing_coeffs['cluster_metric network      ure
     ructst  # Network         
          000)
    ax_iter=1ity(G, mor_centraleigenvect = nx.y']or_centralitnvectrics['eigemetrk_two       ne)
     rality(Gent_ccloseness = nx.lity']eness_centratrics['closnetwork_me         G)
   entrality(ness_cween= nx.bet'] entralityeenness_cetws['brk_metric       netwo     )
entrality(Gx.degree_clity'] = nree_centraics['degork_metrtw  ne       easures
   Centrality m          #  > 0:
  edges()f_.number_o Gif       
 
         {} =tricsrk_metwo ne     ics
  network metrculate       # Cal    
  f}")
    nsity(G):.3y: {nx.densitwork de"   Netprint(f
        eshold}")_thrilarity: {simty thresholdSimilari     print(f"")
      s()}mber_of_edge): {G.nuonstidges (connecrint(f"   E    p()}")
    f_nodesber_o.numates): {G(st Nodes rint(f"  )
        pN:"NSTRUCTIO NETWORK COnt(f"ðŸ”—     pri
     = 1
      s_added +        edge         , j])
   atrix.iloc[iimilarity_might=sate2, westate1, stdd_edge(      G.a          old:
    arity_thresh simili, j] >.iloc[rity_matriximilaand s < j         if i        s):
rix.columnrity_matte(simila enumeratate2 in j, s        for
    x.index):rity_matrilami(sirateenumee1 in stat i,  for 
           
   ded = 0 edges_ad0.6
       = eshold ty_thr similari     ates
   sty similar highl for edges     # Add
    '])
       l_enroll 'totaoc[state,.lrformance']tate_pedata['slments=self.nrol         e           emo'],
  l_d'totaoc[state, '].lanceperformstate_data['es=self. demo_updat                     al_bio'],
tate, 'totnce'].loc[smaperfora['state_lf.datsetes=io_upda  b                    pdates,
total_us=l_updatetota                 e, 
     d_node(stat        G.ad  ]
  _demo'e, 'total'].loc[statperformancedata['state_'] + self.total_bioate, ''].loc[stanceerformate_pta['st = self.daupdates   total_      dex:
   .inrixatty_m in similarior states
        fattribute) with  (states# Add nodes
               
 aph()G = nx.Gr  ph
      etwork graeate n# Cr       
 
        rm.T.corr()_noturese_fea = stat_matrixity    similar
    sureilarity meas simons acorrelatiise culate pairw # Cal        
      )
 () + 1e-8tdfeatures.s/ (state_an()) tures.me state_fea -featurestate_(sm = features_nortate_       s
 culationy callaritsimires for  featuize    # Normal  
       llna(0)
   features].fie'][performanc['state_f.dataatures = sel_fe       state_ratio']
 te_enrolldaupio', 'bio_demo_rat', 'oll 'total_enr_demo',tal_bio', 'tootals = ['tfeature
        rnsatte pmancetate perforsed on srk baetwoilarity ne simeat     # Cr 
   0)
       int("="*6
        prERNS")E PATTINTER-STATLYSIS - ETWORK ANANIQUE 6: NnðŸ•¸ï¸  TECH"\int(
        pr"rns"" PatteteInter-stas for silyNetwork Ana6. ""   "f):
     el_analysis(s_6_networkueechniq  def t   
     w()
      plt.sho
    )t'inches='tigh, bbox_', dpi=300pngtspots.l_hogeospatiafig('5_ plt.save    
   out()t_laylt.tigh  p   
      old')
     ontweight='bontsize=8, f points', fords='offset, 5), textcot=(5       xytex                       ,
core'])ource_need_s['res rowy'],te_intensit'updaow[[:8], (rtate(state[1,1].anno axes          
 s():errow.itteseed_staigh_n, row in h for state
       e')ed_scor'resource_ne(5, rgestnladata.pot_= hotses _stathigh_need     states
   need gh-hils for abestate l     # Add 
       =0.3)
    pharue, al1].grid(Taxes[1,
        ()].legend,1  axes[1   )
   Need Score'rce l('Resou.set_ylabe1] axes[1,       )')
ds(thousany ensitate IntUpdlabel('1].set_x1,   axes[    
 old')tweight='b=14, fon', fontsizeNeedResource sity vs  Inten Updatec Clusters:hile('Geograp,1].set_tit  axes[1
             
 lack')olors='bec edg=0.7,pha    s=80, al                         ',
_id} {clusterClusterabel=f'Geo  lter_id]],luster[clus[colors_c       c=                     ],
 e'corurce_need_sdata['resouster_ty'], cl_intensiatepd['ucluster_data1].scatter(  axes[1,
                     er_mask]
 [clustspot_datata = hotr_da   cluste       ster_id
   == clu']tero_clusot_data['geotsp = h_mask    cluster       (4):
 n range i_idter  for clus    
      
    0, 1, 4))ace(1(np.linsp.Setr = plt.cmuste   colors_cl    er plot
 usters scattographic cl     # 4. Ge          
')
 ld('botweight.set_fon  autotext        )
  r('black'.set_colo  autotext          autotexts:
in or autotext        fchart
 pie  the     # Style    
    )
    t='bold'4, fontweigh=1tsizebution', fonDistriategories d Cource Nee('Res_titleet axes[1,0].s       le=90)
tangolors, starolors=c1f%%', copct='%1.       aut                                        dex, 
  _counts.inoryeg labels=catalues,.vntsry_cou(catego0].pie = axes[1,, autotextss, textsedge   w     ghtgreen']
, 'liyellow'ange', ''red', 'or', edrs = ['darkr       colo
 ue_counts().valcategory']urce_a['reso_dat = hotspotegory_counts     catrt
   chagory pie urce cate Reso        # 3.      
='bold')
  weightze=8, fontter', fontsiva='cen='left', th:.3f}', ha'{wid       f                  2.,
 t()/_heigh + bar.gett_y()bar.geth, ,1].text(wid axes[0      th()
     r.get_wid= ba width        
    ate(bars):enumern ar ifor i, b     
   ue labelsd val      # Ad     
  )
   alpha=0.3id(True, ].gr[0,1  axese')
      Scorrce Need oul('Resabe[0,1].set_xl     axesld')
   'bontweight==14, fozetsi fond', Neesource Re2 States byitle('Top 1.set_t   axes[0,1]
     e=10)ontsiz fs.index,teop_need_staticklabels(tt_yxes[0,1].se
        a))ed_states)(len(top_negeks(ranticset_y].s[0,1     axelack')
   ='bgecolor0.7, edlpha=r='red', a       colo                     
  eed_score'],resource_nates['_need_st), topeed_states)(len(top_n(range,1].barh= axes[0rs        bacore')
 need_se_ 'resourcnlargest(12,spot_data.tates = hot_need_s  top
      ed states ne resource2. Top  #   
         .3)
   a=0e, alphid(Trugr,0].    axes[0    )
nd(eges[0,0].l  axe     ')
 of Statesl('Number labe.set_y[0,0]        axesScore')
rce Need bel('Resouxlat_[0,0].se axes       t='bold')
tweigh4, fonsize=1nttion', fotribuScore Disrce Need Resout_title('[0,0].sexes      a):.3f}')
  an(re"].mescoource_need_"resot_data[ean: {hotsp=f'M, labelth=2ewidlin                     -', 
    estyle='-red', linolor='.mean(), c_score']neede_['resourcotspot_dataaxvline(h axes[0,0].    black')
    edgecolor='alpha=0.7,, or='skyblue', cole'], bins=25corurce_need_s['resospot_data.hist(hot0]     axes[0,  on
 istributire drce need sco 1. Resou    #    
       ')
 ='boldght, fontwei16e=tsiz fonT ANALYSIS',IAL HOTSPO'GEOSPATg.suptitle(
        fi0, 15))(2e= figsiz, 2,ts(2t.subploaxes = pl fig,   """
     sisaly anot hotspspatialeo"""Plot g        ot_data):
spself, hothotspots(atial_lot_geosp def _p 
         data)
 ts(hotspot_ial_hotspolot_geospat     self._pn
   atiovisualizCreate   # 
         
      }ing
       terlus_for_c': featuresfeatures       's,
     : geo_kmeansters' 'geo_clu        ta,
   dapot_': hots 'data         
  ots'] = {atial_hotspts['geospesul  self.r 
          
   t())}")lis[:3].toextates.indster_s(clujoin {', '.Examples:    print(f"         f})")
    eed_score:.3re: {avg_ng Need Sco} states (Aves)tatcluster_sen(}: {lter_idluser {cstf"   Clut(      prin   )
   core'].mean(ource_need_ss['resteuster_staore = cl_need_sc     avg   
    id]er_= clustter'] =['geo_clust_datatspoata[hoot_d= hotspter_states      clus    
    range(4): inter_idus     for clS:")
   CLUSTEREOGRAPHIC "\nðŸŽ¯ Gt(f        print clusters
y hotspoIdentif    #    
    
     st())}")].tolidex[:3gory.intes_in_cate, '.join(staes: {'mpl  Exa"   int(f      pr                else:
      )
        olist())}".try.index_categon(states_in '.joi States: {',     print(f"                   3:
ory) <= _categin(states_  if len         ")
     states} category)tes_in_(staegory}: {len"   {catt(f       prin         y:
y.emptegortates_in_catnot s if          ory]
  teg= cagory'] =ce_cateata['resourot_d[hotsptaspot_dary = hottegotes_in_ca      sta]:
      w Need'y Loer 'Ved',ow Ne'L, eed'', 'Medium N, 'High Need Need' ['Criticalintegory       for ca        
  ata)}")
_dtspoten(ho {ls analyzed:(f"   State   print  ")
   TS: RESULNALYSISPOT AHOTSint(f"ðŸ“  pr
       
        geo_scaled)redict(X_.fit_pgeo_kmeanscluster'] = _data['geo_otspot       htate=42)
 andom_s=4, rers(n_clust = KMeansnseo_kmea       gng
 groupiic or geographmeans f K-   # Apply     
        
geo)m(X_it_transfordScaler().fd = Standar_scale   X_geo     fillna(0)
ring].s_for_clusteureot_data[feat= hotsp X_geo ']
       need_scoresource_roll', 're, 'total_enemo'_do', 'totaltal_biering = ['to_clustures_for     featy
   similaritce rformanpebased on stering luographic c # Ge            
     )
  ']
    cal Needed', 'Criti Neeed', 'High N'Medium', , 'Low NeedNeed'=['Very Low    labels          bins=5,
   ],
        re'sco_need_rceouta['restspot_daho             = pd.cut(
tegory']'resource_cadata[t_tspo      hoce needs
  esours by rize state   # Categor     
     
       )0.3
    d'] * ad_normalizece_lorvi['seot_data hotsp      .3 +
     lized'] * 0ormaatio_nte_enroll_rpdaot_data['uotsp     h      * 0.4 +
 ed'] izity_normalte_intensata['updaspot_d       hot(
     score'] = rce_need_ta['resout_dahotspo      e
   scorrce neede resouate composit  # Calcul    
          n())
tric].mia[mepot_dat) - hotsmetric].max(ata[otspot_d / (hric].min())metpot_data[tric] - hotspot_data[med'] = (hotsze}_normalif'{metrict_data[po  hots          
 metrics:c infor metri      ad']
  e_loicatio', 'servnroll_rate_esity', 'upden_intupdate ['  metrics =ring
      cote ssipoomfor cics rmalize metr   # No       

      roll'] + 1)al_entotpot_data[' / (hotstal_demo'])pot_data['toots+ ho'] al_bi'tottspot_data[ho= (d'] service_loaspot_data['ot      h  ] + 1)
mo''total_deata[ + hotspot_d']'total_biot_data[] / (hotspo_enroll'['totalhotspot_data] = ency'lment_efficiata['enrol hotspot_d000
       _demo']) / 1_data['total hotspototal_bio'] +a['tot_dat] = (hotspntensity'pdate_i_data['u     hotspotors
   spot indicatmultiple hotculate     # Cal         
 )
  nce'].copy(performastate_f.data['ela = s hotspot_dat      lysis
 anave hotspot rehensireate comp      # C        
60)
  ("="*   print")
     OT ANALYSISSPOSPATIAL HOTUE 5: GEHNIQTECnt("\nðŸ—ºï¸        pri""
  sis"otspot Analyatial Hsp"""5. Geo   lf):
     (seal_hotspotseospatiechnique_5_g
    def t     
   t.show()pl      ht')
  es='tiginch00, bbox_dpi=3, s.png'ol_chartontrsavefig('4_c       plt.layout()
 ht_ plt.tig 
       .3)
       , alpha=0rid(Truei].g   axes[
         upper left') loc='5, 1),1.0chor=(box_to_annd(begexes[i].l    a)
        Updates'('Biometric bel_yla.set    axes[i])
        d''Time Periot_xlabel(s[i].se  axe  
        ')ight='boldfontweontsize=14, ', f {state}l Chart -troitle(f'Coni].set_txes[  a          
  
          alpha=0.8))t', ear='whcecolo, fatyle='round'ct(boxs', bbox=di='topcalalignment  verti               
        transAxes,m=axes[i].oransfxt, trtats_te02, 0.98, si].text(0.axes[           
 :.1f}%'"]_pctcontrolof_"out_results[Control: {-of-Out"]}\niolationstal_v"to {results[tions:ola= f'Viats_text     st    x
    s text boticstatis    # Add 
                  ')
   Zoneontroln', label='Cr='gree, cololpha=0.1 al,, lcl, ucen(data))n(range(l_betweees[i].fill   ax      zones
   ontrol l c  # Fil     
                x')
 r='rkeontrol', mat of Cabel='Ou5, l, zorder='red', s=100color=                          ), 
     trol_mask_of_conoutdata.where(n(data)), (lenge.scatter(ra axes[i]       ]
        _masktrol_cona[out_ofdat = esrol_valuout_of_cont              ].index
  l_maskntrof_co_odata[outndices = ntrol_i  out_of_co              
ny():ntrol_mask.aout_of_co      if l)
      ta < lc) | (data > ucl(damask = l_ut_of_contro          o
  ol pointsontrof-clight out-High         #  
           a=0.7)
   alph=':', , linestylelow'color='yel_val),  - stdn_val, meaine(y=max(0hl.axaxes[i]     Ïƒ')
       bel='Â±1=0.7, la':', alphainestyle=llow', llor='yeval, con_val + std_=meane(yxhlii].a       axes[=0.7)
     ha':', alplinestyle=e', ngolor='orastd_val), cl - 2*(0, mean_vane(y=maxhli].axes[i   ax        
 abel='Â±2Ïƒ')=0.7, l=':', alphalinestyle, or='orange' colstd_val, 2*ean_val +e(y=mi].axhlin axes[    s
       ma linelot sig     # P
                 })')
  :,.0fCL ({lcl2, label=f'Linewidth=', lestyle='--'red', lin=lcl, color=(yinees[i].axhl ax   )
        ,.0f})'f'UCL ({ucl:el=th=2, lablinewid, yle='--'nestlied', r='rcl, coloe(y=uinaxhl   axes[i].         ,.0f})')
l:mean_van ({f'Meaabel=, lwidth=3le='-', line', linestyreenr='gloval, cone(y=mean_].axhlis[ixe a         limits
  l ontrot c   # Plo
                    Points')
 ata 'D=0.7, label=h=2, alphainewidtrsize=6, l markeues, 'bo-',, data.val))ta(len(dat(rangees[i].plo   ax       points
  data # Plot            
          td']
   ['ssultsval = re   std_      ]
   l'sults['lc = re  lcl       ['ucl']
    = results  ucl     n']
     ts['meal = resul_vaean         m]
   data'sults['a = re     dat      ):
 ()itemslts.control_resumerate(n enus) itate, resulti, (sor 
        f       [axes]
    axes =         1:
 n_states == f     i           
t='bold')
 6, fontweighe=1sizfontCHARTS', ESS CONTROL OC PRATISTICALe('STsuptitlig.   f
     states))=(18, 4*n_, figsize(n_states, 1plt.subplots= , axes         figts)
_resulolntrs = len(co     n_state"""
   l charts"Plot contro  ""ts):
      _resulontrolrts(self, ctrol_chat_conloef _p 
    ds)
       _resultrolrts(contontrol_chaelf._plot_c
        snatiote visualizCrea      #   
  
      esults control_rs'] =l_chartros['contself.result
              ions}")
  le3_violatations + ruviolrule2_ons + le1_violati{ruations: tal viol To   int(f"  pr        )
   0:.1f}%)"ta)*10ate_dal)/len(sttroon_c(out_ofta)} ({lendastate_/{len(_control)}out_ofntrol: {len(Out-of-coint(f"      pr
           :,.0f}")cl:,.0f} - {uimits: {lcll Lntro   Coprint(f"          )
    _val:,.0f}"}, Std: {stdl:,.0fan_va Mean: {me  t(f"         prin    
 {state}:")int(f"         pr    
              }
     
        > 0 else 0_val_val) if stdtd / (6 * s - lcl)ility': (ucless_capab     'proc          
 iolations,_vons + rule3olatis + rule2_vie1_violationtions': rulotal_viola 't       ,
        tionse3_violas': rulationiole3_v       'rul,
         _violations rule2tions':le2_violaru        '  
      s,ionviolate1_ons': rul_violati  'rule1        
      0,10te_data) * n(stalecontrol) / (out_of_: lenontrol_pct'   'out_of_c            ntrol,
 out_of_col': ntro_of_co       'out         lcl,
     'lcl': 
           ucl,'ucl':                 d_val,
   'std': st         _val,
    an': mean 'me           
    _data,state 'data':                 {
e] =statsults[ol_re       contr    
       
      ions += 1ule3_violat           r     = 4:
    [i:i+5]) >a.iloc_1sigmf sum(beyond           i):
     a) - 4igm(beyond_1s range(len i in        for= 0
    lations le3_vio   ru        r)
 a_lowe one_sigmdata <| (state_) uppera_gmsita > one__da = (stated_1sigmayon      be
      _val)l - stdmean_va, ower = max(0igma_le_s on           d_val
val + stan_ = meigma_upper  one_s        a
  yond 1-sigmve points beonsecutiive c fofur out  Fo # Rule 3:                 
   = 1
   olations +    rule2_vi      
          3]) >= 2:i+i:c[sigma.ilod_2sum(beyon    if       :
      2)igma) - beyond_2slen(n range(   for i i
         olations = 0_viule2           ra_lower)
  < two_sigm_data | (stater)_sigma_uppeata > twoa = (state_dd_2sigm       beyon  _val)
   l - 2 * std mean_vax(0,lower = magma_o_si     tw    
   * std_valal + 2 er = mean_vupp  two_sigma_        2-sigma
  eyond nts be poinsecutiv three co out of 2: Two     # Rule     
       ol)
       trof_conout_ns = len(le1_violatio       ruma
     igeyond 3-soint b 1: One p# Rule      les
      ntrol rual co # Addition
                      
 cl)]< lstate_data | (data > ucl) te_taate_data[(s = st_of_controlout       ints
     ol pot-of-contrify ount      # Ide   
      
         ntrol Limit  # Lower Co_val)stdn_val - 3 * max(0, mea     lcl = mit
       ntrol Lir CoUppeal  # std_val + 3 * n_veacl = m  u            
         
 ata.std() state_dval =td_        sean()
    state_data.mmean_val =            a)
 its (3-sigmontrol lime culat      # Calc  
                    nue
conti      
          :data) < 5en(state_       if l   
             
 ]otal_bio'== state]['tate'] aily['st_dly[bioo_daite_data = bi    sta
        ates: in top_st state        for
        
{}= rol_results nt       co
      .")
   s[:3])}..top_staten(oi '.jtates: {', St(f"  in   prs")
     es)} stateat_sttopp {len( for tool chartstrreating conint(f"ðŸ“Š C
        pr      st()
  .index.tolibio')6, 'total_nlargest(ance'].ate_performata['stf.dstates = sel    top_   pdates
 c u biometries by totalp 6 statelect to        # S   
    ge_17_']
 bio_aily['_da17'] + bio'bio_age_5_y[ = bio_dailo']'total_biy[ bio_dail
       ex()eset_ind   }).rsum'
     : 'bio_age_17_'    '       
  'sum',o_age_5_17':        'bi   ']).agg({
 te', 'state['dagroupby(iometric'].a['b self.datly =   bio_daitates
     p sr toily data foe daparPre
        # )
        "="*60t(        prinHARTS")
S CONTROL CCESPROICAL  4: STATISTðŸ“Š TECHNIQUE("\n    print"
    ""l Charts Controcesstistical Pro. Sta """4       lf):
rts(seol_chaue_4_contrhniqef tec    d      
 + 1))
  l']'total_enrolance'][_performateta['stself.da (                                                            ) / 
   al_demo']nce']['totperformaata['state_ self.d                                                         + 
       total_bio'] e']['erformancate_pelf.data['stio'] = ((sroll_ratdate_enmance']['upstate_perforf.data['el
        s))] + 1al_demo'e']['tot_performanca['stateat  (self.d                                                   
      _bio'] / ['totalce']ormante_perfta['sta (self.da'] =ratioo_o_dembi]['rmance'perfota['state_   self.da   e ratios
  formanc # Per           
  um'])
  dult_sroll_ace']['enormantate_perfdata['s      self.                                             + 
      th_sum'] oull_y'enro][erformance'te_pf.data['sta    sel                                             
        ] + child_sum''enroll_ce'][rforman_peata['statef.dsel] = (enroll'['total_erformance']state_p.data['  selfm'])
      _sudemo_adulte']['mancrfortate_pedata['s      self.                                                '] + 
 uth_sume']['demo_yoe_performanc'statata['] = (self.d['total_demo']anceate_perform.data['stself       sum'])
 _adult_mance']['biotate_perfora['s.dat       self                                               sum'] + 
th_'bio_youce'][e_performanstat(self.data['_bio'] = nce']['totale_performa'statta[   self.da      metrics
ate derivedculal # C           
a(0)
    lnfilce'].e_performanta['statlf.daseance'] = formperata['state_elf.d       s
 how='outer')rue, =T_index rightx=True,t_indeagg, lefe'], enroll_performanc['state_elf.data.merge(sance'] = pde_perform'statf.data[    sel   
 ow='outer')ndex=True, hht_iex=True, rigind, left_ demo_aggrge(bio_agg,ce'] = pd.merformane_pea['statlf.dat        se all data
erge M        #
        
d']ult_st_ad', 'enrolll_adult_meanenrolt_sum', 'oll_adulenr           '          
        th_std',l_you, 'enrol_youth_mean'rollum', 'enoll_youth_s 'enr                          ld_std',
  'enroll_chimean', l_child_enrolum', '_child_s'enroll = [mnsagg.colu   enroll_0)
      }).fillna(']
       n', 'std', 'meater': ['sumgrea    'age_18_    ,
     'std'], 'mean',um' ['sage_5_17':      'd'],
      , 'stn'sum', 'meae_0_5': ['       'ag   
  ({aggy('state')..groupbnrollment']f.data['e= selnroll_agg  e       nt data
e enrollmeggregat       # A     
 d']
   t_st_adulean', 'demoo_adult_mm', 'dememo_adult_su'd                           td',
o_youth_sean', 'demyouth_mo_ 'demh_sum',youts = ['demo_mno_agg.colu      demllna(0)
       }).fi
   td'], 'smean''sum', '7_': [_1o_age  'dem      '],
    , 'stdan', 'me'sum' [_17':o_age_5  'dem
          {ate').agg(oupby('stphic'].grdemogralf.data['mo_agg = se  de     hic data
 ograpregate demgg# A
        
        std']t_ 'bio_adulult_mean',um', 'bio_addult_so_a'bi                       d', 
   stth_youean', 'bio_'bio_youth_muth_sum', ['bio_youmns = .col  bio_agg   llna(0)
   }).fi']
        'stdean', um', 'mge_17_': ['s     'bio_a    
   ', 'std'],, 'mean_17': ['sum'  'bio_age_5
          agg({by('state').tric'].groupbiomedata['self.g =  bio_agata
       ic dtr biomegregate# Ag      "
  t""aseance dat performtatensive ste compreherea"""C      :
  (self)e_datae_performance_stat _creat
    def
        roll")en):,} ollment']data['enrelf.o, {len(sem]):,} dc'raphimogdata['den(self. bio, {leetric']):,}ta['biomdaself.ed: {len(ad Data lo  print(f"âœ…   
      )
     data(rmance_e_perfote_statf._crea  sel  
    mance dataate perforCreate st
        #   ce')
      rrors='coerY', eat='%d-%m-%te'], form['daime(dfto_datetd.e'] = p    df['dat:
        ata.items()f.d df in sel key,for
        esvert dat     # Con       
   )
 ueex=Trnds, ignore_iroll_dfconcat(en] = pd.nt'lme'enrolelf.data[      sl_files]
  n enrolfile iile) for _csv(f[pd.readfs = roll_d    en
    .csv')nt/*rolmehar_endata_aadi_t/aphar_enrolmena_aad('api_datglob glob.roll_files =     en
   ment datallenrod     # Loa    
    =True)
    gnore_indexmo_dfs, ioncat(ded.chic'] = papgrf.data['demo  sels]
      demo_fileile in r fle) fo(fiad_csvd.re[pmo_dfs =     de    v')
phic/*.csr_demograi_data_aadhaob.glob('apiles = gl   demo_f
     datac raphi demog      # Load    
     True)
 ndex=e_i_dfs, ignor.concat(bio= pdetric'] f.data['biom
        sel]bio_filesle in  fiforle) ficsv( [pd.read_fs =     bio_d
   )ic/*.csv'biometrta_aadhar_lob('api_dab.gfiles = glo        bio_tric data
biome    # Load 
            
...") datasetsng Aadhaarnt("ðŸ”„ Loadi    pri"
    "sets"d all data """Loa
       lf):load_data(sedef     
    }
    esults = {    self.r{}
    self.data = :
        nit__(self)    def __i
s:AnalyticdvancedeAlass Complet

cn-v0_8').use('seabor.styleltignore')
pings('arnterw.fil

warningsort adfullerimps stattooldels.tsa.moats st
fromort ARIMA impima.models.tsa.arm statsmodelimports
froime Series 

# Toreette_scmport silhourics ilearn.metsk PCA
from on importcompositirn.de sklea
fromardScalerport Stand imeprocessingarn.prrom skle
fs KMeanportn.cluster imom skleart
fronForesrt Isolati impoarn.ensembles
from skleportarning imhine Leorm

# Mact, squarefrt pdisnce impoistaal.datirom scipy.spstats
fipy import rom scrkx as nx
fwonet
import met datetiime imporatetglob
from d
import rnings
import waplotsubort make_ss imply.subplot
from plotgoects as .graph_objt plotlyors as px
imp.exprestlylot pimpor as sns
bornimport sealot as plt
otlib.pyprt matpl